import requests
import math
import openpyxl
from openpyxl.drawing.image import Image
import pandas as pd
from pathlib import Path
from datetime import date

miniåƒ¹ç›®è¡¨ = {
    'miniäºŒç¯€': { 90: 10900, 100:11200, 120: 11490, 150: 12400},
    'miniä¸‰ç¯€': { 90: 13400, 100:13700, 120: 13990, 150: 14900},
    'miniäºŒç¯€é»‘': { 90: 10900, 100:11200, 120: 11490, 150: 12400},
    'miniä¸‰ç¯€é»‘': { 90: 13400, 100:13700, 120: 13990, 150: 14900},
    'miniäºŒç¯€ç™½': { 90: 10900, 100:11200, 120: 11490, 150: 12400},
    'miniä¸‰ç¯€ç™½': { 90: 13400, 100:13700, 120: 13990, 150: 14900}
}

primeåƒ¹ç›®è¡¨ = {
    'primeäºŒç¯€': {
        100: {60: 12990, 80: None}, 
        120: {60: 12990, 80: 13500}, 
        150: {60: 13900, 80: 14500}, 
        180: {60: None, 80: 16100}
    },
    'primeä¸‰ç¯€': {
        100: {60: 15490, 80: None}, 
        120: {60: 15490, 80: 16000}, 
        150: {60: 16400, 80: 17000}, 
        180: {60: None, 80: 18600}
    },
    'primeäºŒç¯€é»‘': {
        100: {60: 12990, 80: None}, 
        120: {60: 12990, 80: 13500}, 
        150: {60: 13900, 80: 14500}, 
        180: {60: None, 80: 16100}
    },
    'primeä¸‰ç¯€é»‘': {
        100: {60: 15490, 80: None}, 
        120: {60: 15490, 80: 16000}, 
        150: {60: 16400, 80: 17000}, 
        180: {60: None, 80: 18600}
    },
    'primeäºŒç¯€ç™½': {
        100: {60: 12990, 80: None}, 
        120: {60: 12990, 80: 13500}, 
        150: {60: 13900, 80: 14500}, 
        180: {60: None, 80: 16100}
    },
    'primeä¸‰ç¯€ç™½': {
        100: {60: 15490, 80: None}, 
        120: {60: 15490, 80: 16000}, 
        150: {60: 16400, 80: 17000}, 
        180: {60: None, 80: 18600}
    }
}

forceåƒ¹ç›®è¡¨ = {
    150: {80: 26000, 90: 26300},
    160: {80: 26500, 90: 26800},
    180: {80: 27600, 90: 27900},
    200: {80: 28300, 90: 28600},
    220: {80: 28800, 90: 29100}
}


å®¢è£½åƒ¹ç›®è¡¨ = {
    (90,90):{
        (50,60):1990,
        (61,80):2500,
        (81,90):2800
    },
    (90.1,119.9):{
        (50,60):1990,
        (61,80):2500,
        (81,90):2800
    },
        (120,120):{
        (50,60):1990,
        (61,80):2500,
        (81,90):2800
    },
        (120.1,135):{
        (50,60):2400,
        (61,80):3000,
        (81,90):3300
    },
        (135.1,149.9):{
        (50,60):2900,
        (61,80):3500,
        (81,90):3800
    },
        (150,150):{
        (50,60):2900,
        (61,80):3500,
        (81,90):3800
    },
        (150.1,165):{
        (50,60):3400,
        (61,80):4000,
        (81,90):4300
    },
        (165.1,179.9):{
        (50,60):3900,
        (61,80):4500,
        (81,90):4800
    },
        (180,180):{
        (50,60):4400,
        (61,80):5100,
        (81,90):5400
    },
        (180.1,185):{
        (50,60):4600,
        (61,80):5500,
        (81,90):5800
    },
        (185.1,199.9):{
        (50,60):None,
        (61,80):6000,
        (81,90):6300
    },
        (200,200):{
        (50,60):None,
        (61,80):6000,
        (81,90):6300
    },
        (200.1,219.9):{
        (50,60):None,
        (61,80):6800,
        (81,90):7100
    },
        (220,220):{
        (50,60):None,
        (61,80):7000,
        (81,90):7300
    }
}

#è¦æ ¼å“ç¥ç€æœ¨åƒ¹ç›®è¡¨
è¦æ ¼ç¥ç€æœ¨åƒ¹ç›®è¡¨={
    (50,70):{
        (90,120):9800,
        (120.1,150):12500,
        (150.1,180):14500,
        (180.1,210):16500,
        (210.1,240):18500
    },
    (71,90):{
        (120,149.9):11500,
        (150,179.9):14500,
        (180,209.9):17500,
        (210,239.9):20500,
        (240,240):22500
    }
}

                    
æœ¨ç¨®æˆæœ¬å–®åƒ¹list={'æ “æœ¨è„‚æ¥':700,'æ “æœ¨ç›´æ‹¼':900,'ç™½æ©¡æœ¨è„‚æ¥':850,'ç™½æ©¡æœ¨ç›´æ‹¼':1330}
æœ¨ç¨®å°å®¢å–®åƒ¹ä¹˜ç©list={'æ “æœ¨è„‚æ¥':1.5,'æ “æœ¨ç›´æ‹¼':1.5,'ç™½æ©¡æœ¨è„‚æ¥':1.4,'ç™½æ©¡æœ¨ç›´æ‹¼':1.4,'ç¥ç€æœ¨':1.6}

æ¡Œè…³_list={'primeä¸‰ç¯€':13500,'primeä¸‰ç¯€é»‘':13500,'primeä¸‰ç¯€ç™½':13500,
         'primeäºŒç¯€':11000,'primeäºŒç¯€é»‘':11000,'primeäºŒç¯€ç™½':11000,
         'miniä¸‰ç¯€':12000,'miniä¸‰ç¯€é»‘':12000,'miniä¸‰ç¯€ç™½':12000,
         'miniäºŒç¯€':9500,'miniäºŒç¯€é»‘':9500,'miniäºŒç¯€ç™½':9500,
         'å›ºå®šæ¡Œè…³':3980,'å›ºå®šé»‘è…³':3980,'å›ºå®šç™½è…³':3980,
         'force':23500,'forceæ¡Œè…³':23500,'forceå››æŸ±æ¡Œè…³':23500,'forceå››æŸ±é»‘è…³':23500,'forceå››æŸ±ç™½è…³':23500,'':0}
é¡è‰²_list={'':0,'çº–ç¶­æ¿':0,'è¸è‰æ©¡æœ¨':0,'é›ªç™½æŸšæœ¨':0,'å¯†è¥¿æ ¹æ¥“æœ¨':0,'åŒ—æ­ç™½æ©¡æœ¨':0,'å…¸é›…èƒ¡æ¡ƒæœ¨':0,'æ­é¢¨èƒ¡æ¡ƒæœ¨':0,'é»‘':0,'ç™½':0,'é›»ç«¶':0,'åŠ æ‹¿å¤§æ¥“æœ¨':0, 
         'èœ‚å·¢æ¿':1500,'é»‘é›²å²©':1500,'ç™½é›²å²©':1500,'æ³¥ç°å²©':1500,'å®‰è—¤æ¸…æ°´æ¨¡':1500,'å°ç£æŸšæœ¨':1500,'åŒ—æµ·é“æ¦†æœ¨':1500,'ç¶­å‰å°¼äºæ¥“æœ¨':1500,'å®‰å¾·æ£®é›ªæ¾':1500,'å“¥å€«æ¯”äºèƒ¡æ¡ƒ':1500,}
å½¢ç‹€_list={'':0,'å››æ–¹å‰ä¸Šæ–œ':0,'å¼§åº¦ä¸Šæ–œ':0,'å››æ–¹å…¨å¹³':0,'å‰å‡¹':800,'å¾Œå‡¹':800,'å‰å‡¹+å¾Œå‡¹':800,'å°åœ“å¼§å¾Œå‡¹':800,'å‰å‡¹+å°åœ“å¼§å¾Œå‡¹':800,'å››æ–¹å‰ä¸Šæ–œ+å¾Œå‡¹':800,'å››æ–¹å‰ä¸Šæ–œ+å°åœ“å¼§å¾Œå‡¹':800,'å¼§åº¦ä¸Šæ–œ+å¾Œå‡¹':800,'å¼§åº¦ä¸Šæ–œ+å°åœ“å¼§å¾Œå‡¹':800,'å››è§’å°åœ“':800}

while True:
    print('\n')
    try:
       å ±åƒ¹ =input('è«‹è¼¸å…¥è¦æ ¼æˆ–è¨‚è£½æˆ–è£½ææ‰€æˆ–ä¸‹å–®æˆ–å ±åƒ¹å–®:')
    except Exception as e:
        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
    else:

        if å ±åƒ¹ == 'è¦æ ¼':
            try:
                æ¡Œå¯¬ = float(input('è«‹è¼¸å…¥æ¡Œå¯¬:'))
                æ¡Œæ·± = float(input('è«‹è¼¸å…¥æ¡Œæ·±:'))
                æ¡Œè…³ = input('è«‹è¼¸å…¥æ¡Œè…³:')
                é¡è‰² = input('è«‹è¼¸å…¥æ¡Œæ¿é¡è‰²:')
                å½¢ç‹€ = input('è«‹è¼¸å…¥æ¡Œæ¿å½¢ç‹€:')

                é¡è‰²price=é¡è‰²_list[é¡è‰²]
                å½¢ç‹€price=å½¢ç‹€_list[å½¢ç‹€]  
                æ¡Œè…³price=æ¡Œè…³_list[æ¡Œè…³]
            except Exception as e:
                print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
            else:       
                if æ¡Œè…³ == 'miniä¸‰ç¯€' or æ¡Œè…³ == 'miniäºŒç¯€' or æ¡Œè…³ == 'miniä¸‰ç¯€é»‘' or æ¡Œè…³ == 'miniä¸‰ç¯€ç™½' or æ¡Œè…³ == 'miniäºŒç¯€é»‘' or æ¡Œè…³ == 'miniäºŒç¯€ç™½':
                    try:
                        miniå‡é™æ¡Œprice = float(miniåƒ¹ç›®è¡¨[æ¡Œè…³][æ¡Œå¯¬])
                        é¡è‰²price=é¡è‰²_list[é¡è‰²]
                        å½¢ç‹€price=å½¢ç‹€_list[å½¢ç‹€] 
                        
                        if æ¡Œæ·± != 60:
                            print('miniè¦æ ¼æ¡Œæ·±é ˆç‚º60!!!')
                            continue
                    except Exception as e:
                        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e) 
                    else:
                        total=miniå‡é™æ¡Œprice+é¡è‰²price+å½¢ç‹€price
        
                        print('å’Œæ‚¨å ±åƒ¹')
                        print('%3.0f*%2.0f%s(%s)+%s=%5.0f'%(æ¡Œå¯¬,æ¡Œæ·±,é¡è‰²,å½¢ç‹€,æ¡Œè…³,total))  
                    
                elif æ¡Œè…³ == 'primeä¸‰ç¯€' or æ¡Œè…³ == 'primeäºŒç¯€' or æ¡Œè…³ == 'primeä¸‰ç¯€é»‘' or æ¡Œè…³ == 'primeä¸‰ç¯€ç™½' or æ¡Œè…³ == 'primeäºŒç¯€é»‘' or æ¡Œè…³ == 'primeäºŒç¯€ç™½':
                    try:       
                        primeå‡é™æ¡Œprice = float(primeåƒ¹ç›®è¡¨[æ¡Œè…³][æ¡Œå¯¬][æ¡Œæ·±])
                        é¡è‰²price=é¡è‰²_list[é¡è‰²]
                        å½¢ç‹€price=å½¢ç‹€_list[å½¢ç‹€]
                    except Exception as e:
                        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
                    else:
                        total=primeå‡é™æ¡Œprice+é¡è‰²price+å½¢ç‹€price
                        if 45<æ¡Œæ·±<=60:
                            æ¡Œè…³=æ¡Œè…³+'(è…³åº•åº§60å…¬åˆ†)'
        
                        print('å’Œæ‚¨å ±åƒ¹')
                        print('%3.0f*%2.0f%s(%s)+%s=%5.0f'%(æ¡Œå¯¬,æ¡Œæ·±,é¡è‰²,å½¢ç‹€,æ¡Œè…³,total))
            
                elif æ¡Œè…³ == 'force'or æ¡Œè…³ == 'forceå››æŸ±æ¡Œè…³' or æ¡Œè…³ == 'forceå››æŸ±é»‘è…³' or æ¡Œè…³ == 'forceå››æŸ±ç™½è…³':
                    try:
                        forceå‡é™æ¡Œprice = float(forceåƒ¹ç›®è¡¨[æ¡Œå¯¬][æ¡Œæ·±])
                        é¡è‰²price=é¡è‰²_list[é¡è‰²]
                        å½¢ç‹€price=å½¢ç‹€_list[å½¢ç‹€]
                    except Exception as e:
                        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
                    else:
                        total=forceå‡é™æ¡Œprice+é¡è‰²price+å½¢ç‹€price
                
                        print('å’Œæ‚¨å ±åƒ¹')
                        if é¡è‰²price != 0:
                            print('è¨‚%3.0f*%2.0f*4%s(%s)+%s=%5.0f'%(æ¡Œå¯¬,æ¡Œæ·±,é¡è‰²,å½¢ç‹€,æ¡Œè…³,total))
                        else:
                            print('%3.0f*%2.0f%s(%s)+%s=%5.0f'%(æ¡Œå¯¬,æ¡Œæ·±,é¡è‰²,å½¢ç‹€,æ¡Œè…³,total))
        
        elif å ±åƒ¹ == 'è¨‚è£½':
            try:
                æ¡Œå¯¬ = float(input('è«‹è¼¸å…¥æ¡Œå¯¬:'))
                æ¡Œæ·± = math.ceil(float(input('è«‹è¼¸å…¥æ¡Œæ·±:')))
                æ¡Œè…³=input('è«‹è¼¸å…¥æ¡Œè…³:')
                é¡è‰²=input('è«‹è¼¸å…¥æ¡Œæ¿é¡è‰²:')
                å½¢ç‹€=input('è«‹è¼¸å…¥æ¡Œæ¿å½¢ç‹€:')

                found = False
    
                for width_range, depth_dict in å®¢è£½åƒ¹ç›®è¡¨.items():
                    width_start, width_end = width_range
                    if width_start <= æ¡Œå¯¬ <= width_end:
        
                        for depth_range, value in depth_dict.items():
                            depth_start, depth_end = depth_range
                            if depth_start <= æ¡Œæ·± <= depth_end:
                                price = value
                                found = True
                                break #æ‰¾åˆ°å¯¬åº¦å°±åœæ­¢æŸ¥æ‰¾
                        break #æ‰¾åˆ°æ·±åº¦å°±åœæ­¢æŸ¥æ‰¾
        
                if not found:
                    price = 0
                    print('æŸ¥ç„¡åƒ¹æ ¼!!!')
        
                æ¡Œè…³price=æ¡Œè…³_list[æ¡Œè…³]
                é¡è‰²price=é¡è‰²_list[é¡è‰²]
                å½¢ç‹€price=å½¢ç‹€_list[å½¢ç‹€]
                
                def format_width_number(æ¡Œå¯¬):
                    return str(int(æ¡Œå¯¬)) if æ¡Œå¯¬ == int(æ¡Œå¯¬) else str(æ¡Œå¯¬)
                
            except Exception as e:
                print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
            else:
                total=price+æ¡Œè…³price+é¡è‰²price+å½¢ç‹€price
                
                print('å’Œæ‚¨å ±åƒ¹')
                if æ¡Œè…³price == 0 and é¡è‰²price != 0 and å½¢ç‹€price != 0:
                    total = total + 400
                    print(f'å–®è³¼æ¡Œæ¿è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})={total}')
                    print('\n''å‚™è¨»:')
                    print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                    print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                    print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')                     
                elif æ¡Œè…³price == 0 and é¡è‰²price != 0:
                    total = total + 400
                    print(f'å–®è³¼æ¡Œæ¿è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})={total}')
                    print('è«‹è‡ªè¡Œåˆ¤æ–·æ˜¯å¦ç‚ºè¨‚è£½!!')
                    print('\n''å‚™è¨»:')
                    print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                    print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                    print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»') 
                elif æ¡Œè…³price == 0:
                    total = total + 200
                    print(f'å–®è³¼æ¡Œæ¿è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})={total}')
                    print('è«‹è‡ªè¡Œåˆ¤æ–·æ˜¯å¦ç‚ºè¨‚è£½!!')
                    print('\n''å‚™è¨»:')
                    print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                    print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                    print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»') 
                elif price == 0:
                    print('è¨‚è£½å°ºå¯¸æœ‰èª¤ï¼Œæ³¨æ„æ¡Œæ·±æœ€å°50')
                elif æ¡Œå¯¬<110 and (æ¡Œè…³=='primeä¸‰ç¯€' or æ¡Œè…³=='primeäºŒç¯€' or æ¡Œè…³=='primeä¸‰ç¯€é»‘' or æ¡Œè…³=='primeäºŒç¯€é»‘'or æ¡Œè…³=='primeä¸‰ç¯€ç™½' or æ¡Œè…³=='primeä¸‰ç¯€ç°'or æ¡Œè…³=='primeäºŒç¯€ç°' or æ¡Œè…³=='å›ºå®šæ¡Œè…³' or æ¡Œè…³ =='å›ºå®šç™½è…³' or æ¡Œè…³ == 'å›ºå®šé»‘è…³') and æ¡Œæ·±<57.5:
                    æ¡Œè…³=æ¡Œè…³+'(çŸ­ç‰ˆ+çŸ­å´ç‰‡+è…³åº•åº§45å…¬åˆ†)'
                    if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                        if å½¢ç‹€ == 'å››è§’å°åœ“':
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»') 
                        else:
                            print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                    elif é¡è‰²price != 0:
                        print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                        print('\n''å‚™è¨»:')
                        print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                        print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                        print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    else:
                        if å½¢ç‹€ == 'å››è§’å°åœ“':
                            print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                        else:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
        
                elif æ¡Œå¯¬<110 and (æ¡Œè…³=='primeä¸‰ç¯€' or æ¡Œè…³=='primeäºŒç¯€' or æ¡Œè…³=='primeä¸‰ç¯€é»‘' or æ¡Œè…³=='primeäºŒç¯€é»‘'or æ¡Œè…³=='primeä¸‰ç¯€ç™½' or æ¡Œè…³=='primeäºŒç¯€ç™½' or æ¡Œè…³=='primeä¸‰ç¯€ç°'or æ¡Œè…³=='primeäºŒç¯€ç°' or æ¡Œè…³=='å›ºå®šæ¡Œè…³' or æ¡Œè…³ =='å›ºå®šç™½è…³' or æ¡Œè…³ == 'å›ºå®šé»‘è…³') and æ¡Œæ·±>=57.7:
                    if 57.5<=æ¡Œæ·±<60:
                        æ¡Œè…³=æ¡Œè…³+'(çŸ­ç‰ˆ+è…³åº•åº§45å…¬åˆ†)'
                        if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                            else:
                                print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                        elif é¡è‰²price != 0:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                            else:
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    elif 60<=æ¡Œæ·±<68:
                        æ¡Œè…³=æ¡Œè…³+'(çŸ­ç‰ˆ+è…³åº•åº§60å…¬åˆ†)'
                        if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                            else:
                                print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                        elif é¡è‰²price != 0:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                            else:
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    else:
                        æ¡Œè…³=æ¡Œè…³+'(çŸ­ç‰ˆ)'
                        if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                            else:
                                print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                        elif é¡è‰²price != 0:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                            else:
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
               
                elif æ¡Œæ·±<68 and (æ¡Œè…³=='primeä¸‰ç¯€' or æ¡Œè…³=='primeäºŒç¯€' or æ¡Œè…³=='primeä¸‰ç¯€é»‘' or æ¡Œè…³=='primeäºŒç¯€é»‘'or æ¡Œè…³=='primeä¸‰ç¯€ç™½' or æ¡Œè…³=='primeäºŒç¯€ç™½' or æ¡Œè…³=='primeä¸‰ç¯€ç°'or æ¡Œè…³=='primeäºŒç¯€ç°'or æ¡Œè…³=='å›ºå®šæ¡Œè…³' or æ¡Œè…³ =='å›ºå®šç™½è…³' or æ¡Œè…³ == 'å›ºå®šé»‘è…³'):
                    if 57.5<=æ¡Œæ·±<68:
                        æ¡Œè…³=æ¡Œè…³+'(è…³åº•åº§60å…¬åˆ†)'
                        if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                            else:
                                print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                        elif é¡è‰²price != 0:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                            else:
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    elif æ¡Œæ·±<57.5:
                        æ¡Œè…³=æ¡Œè…³+'(çŸ­å´ç‰‡+è…³åº•åº§45å…¬åˆ†)'
                        if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                            else:
                                print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                        elif é¡è‰²price != 0:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            if å½¢ç‹€ == 'å››è§’å°åœ“':
                                print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                            else:
                                print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                                print('\n''å‚™è¨»:')
                                print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                                print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                                print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                                
                elif æ¡Œæ·±<60 and (æ¡Œè…³=='miniä¸‰ç¯€' or æ¡Œè…³=='miniäºŒç¯€' or æ¡Œè…³=='miniä¸‰ç¯€ç™½' or æ¡Œè…³=='miniäºŒç¯€ç™½' or æ¡Œè…³=='miniä¸‰ç¯€é»‘' or æ¡Œè…³=='miniäºŒç¯€é»‘'or æ¡Œè…³=='å›ºå®šæ¡Œè…³' or æ¡Œè…³ =='å›ºå®šç™½è…³' or æ¡Œè…³ == 'å›ºå®šé»‘è…³'):
                    æ¡Œè…³ = æ¡Œè…³+'(è…³åº•åº§45å…¬åˆ†)'
                    print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                    print('\n''å‚™è¨»:')
                    print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                    print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                    print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    
                elif æ¡Œæ·±<72 and æ¡Œè…³=='force':
                    print('æ¡Œæ·±ç„¡æ³•å®‰è£force!')
        
                else:
                    if é¡è‰²price != 0 and å½¢ç‹€price != 0:
                        if å½¢ç‹€ == 'å››è§’å°åœ“':
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            print('èœ‚å·¢æ¿ä¸å¯åšå‡¹!!')
                    elif é¡è‰²price != 0:
                        print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}*4{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                        print('\n''å‚™è¨»:')
                        print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                        print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                        print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                    else:
                        if å½¢ç‹€ == 'å››è§’å°åœ“':
                            print('çº–ç¶­æ¿ä¸€å®šå››è§’å°åœ“ï¼Œè«‹åˆªé™¤!!(å¦å‰‡å ±åƒ¹æœ‰èª¤)')
                        else:
                            print(f'è¨‚{format_width_number(æ¡Œå¯¬)}*{æ¡Œæ·±}{é¡è‰²}({å½¢ç‹€})+{æ¡Œè…³}={total}')
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„35å¤©(å«å‡æ—¥)')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
            
        elif å ±åƒ¹ == 'è£½ææ‰€':
            try:
                æœ¨ç¨®=input('è«‹è¼¸å…¥æœ¨ç¨®:')
            except Exception as e:
                print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
            else:

                if  (æœ¨ç¨® =='æ “æœ¨è„‚æ¥' or æœ¨ç¨® =='æ “æœ¨ç›´æ‹¼' or æœ¨ç¨® =='ç™½æ©¡æœ¨è„‚æ¥' or æœ¨ç¨® =='ç™½æ©¡æœ¨ç›´æ‹¼'):
                    try:
                        æ¡Œå¯¬=float(input('è«‹è¼¸å…¥æ¡Œå¯¬:'))
                        æ¡Œæ·±=float(input('è«‹è¼¸å…¥æ¡Œæ·±:'))
                        åšåº¦=float(input('è«‹è¼¸å…¥åšåº¦(è‹¥ç™½æ©¡æœ¨ç›´æ‹¼3.3è«‹è¼¸å…¥3.5):'))
                        æ¡Œè…³=input('è«‹è¼¸å…¥æ¡Œè…³:') 
                        æ¡Œè…³price=æ¡Œè…³_list[æ¡Œè…³] 

                    except Exception as e:
                        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
                    else:
                        if æ¡Œè…³ == '':
                            æ¡Œæ¿price=round(æ¡Œå¯¬*æ¡Œæ·±*åšåº¦/2700*æœ¨ç¨®æˆæœ¬å–®åƒ¹list[æœ¨ç¨®]*æœ¨ç¨®å°å®¢å–®åƒ¹ä¹˜ç©list[æœ¨ç¨®],-2)
                            total=æ¡Œæ¿price+400
                            print('å’Œæ‚¨å ±åƒ¹')
                            print('(è£½ææ‰€)-å–®è³¼æ¡Œæ¿è¨‚%3.0f*%3.0f*%1.1f%s=%5.0f' % (æ¡Œå¯¬,æ¡Œæ·±,åšåº¦,æœ¨ç¨®,total))
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å·¥ä½œå¤©')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        if æ¡Œæ·± >= 81 and åšåº¦<=2.7:
                            print('ç„¡æ³•è£½ä½œ!!æ¡Œæ·±åšåº¦81cmä»¥ä¸Šï¼Œåšåº¦éœ€ç‚º3.3ä»¥ä¸Š')
                        else:
                            æ¡Œæ¿price=round(æ¡Œå¯¬*æ¡Œæ·±*åšåº¦/2700*æœ¨ç¨®æˆæœ¬å–®åƒ¹list[æœ¨ç¨®]*æœ¨ç¨®å°å®¢å–®åƒ¹ä¹˜ç©list[æœ¨ç¨®],-2)
                            total=æ¡Œæ¿price+æ¡Œè…³price
                            print('å’Œæ‚¨å ±åƒ¹')
                            print('(è£½ææ‰€)-è¨‚%3.0f*%3.0f*%1.1f%s+%s=%5.0f' % (æ¡Œå¯¬,æ¡Œæ·±,åšåº¦,æœ¨ç¨®,æ¡Œè…³,total))
                            print('\n''å‚™è¨»:')
                            print('1. ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å·¥ä½œå¤©')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                elif æœ¨ç¨® == 'ç¥ç€æœ¨':
                    try:
                        æ¡Œå¯¬=float(input('è«‹è¼¸å…¥æ¡Œå¯¬:'))
                        æ¡Œæ·±=float(input('è«‹è¼¸å…¥æ¡Œæ·±:'))
                        åšåº¦=float(input('åšåº¦è«‹è¼¸å…¥4.5:'))
                        æ¡Œè…³=input('è«‹è¼¸å…¥æ¡Œè…³:') 
             
                        for wood_depth_range, wood_width_dict in è¦æ ¼ç¥ç€æœ¨åƒ¹ç›®è¡¨.items():
                            wood_depth_start, wood_depth_end = wood_depth_range
                            if wood_depth_start <= æ¡Œæ·± <= wood_depth_end:
        
                                for wood_width_range, wood_value in wood_width_dict.items():
                                    wood_width_start, wood_width_end = wood_width_range
                                    if wood_width_start <= æ¡Œå¯¬ <= wood_width_end:
                                        price = wood_value
                                        break #æ‰¾åˆ°å¯¬åº¦å°±åœæ­¢æŸ¥æ‰¾
                                break #æ‰¾åˆ°æ·±åº¦å°±åœæ­¢æŸ¥æ‰¾
        
                        else:
                            print('ç„¡åƒ¹æ ¼')

                        æ¡Œæ¿price = price*æœ¨ç¨®å°å®¢å–®åƒ¹ä¹˜ç©list[æœ¨ç¨®]
                    except Exception as e:
                        print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
                    else:
                        if æ¡Œè…³ == '':
                            total=æ¡Œæ¿price+400
                            print('å’Œæ‚¨å ±åƒ¹')
                            print('(è£½ææ‰€)-å–®è³¼æ¡Œæ¿è¨‚%3.0f*%3.0f*%1.1f%s=%5.0f' % (æ¡Œå¯¬,æ¡Œæ·±,åšåº¦,æœ¨ç¨®,total))
                            print('\n''å‚™è¨»:')
                            print('1. 1.ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å·¥ä½œå¤©')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                        else:
                            total=æ¡Œæ¿price+æ¡Œè…³price
                            print('å’Œæ‚¨å ±åƒ¹')
                            print('(è£½ææ‰€)-è¨‚%3.0f*%3.0f*%1.1f%s+%s=%5.0f' % (æ¡Œå¯¬,æ¡Œæ·±,åšåº¦,æœ¨ç¨®,æ¡Œè…³,total))
                            print('\n''å‚™è¨»:')
                            print('1. 1.ä»¥ä¸Šé‡‘é¡å«é‹(ä¸å«å®œèŠ±æ±åœ°å€)ã€ä¸å«å®‰è£')
                            print('2. è¨‚è£½ç´„45å·¥ä½œå¤©')
                            print('3. è£½ç¨‹ç‚ºå·¥å» è£½ä½œæ™‚é–“ï¼Œä¸åŒ…å«å¾ŒçºŒçš„é…é€èˆ‡å®‰è£ï¼Œå¯¦éš›é…é€æ—¥ä»¥é€šçŸ¥ç‚ºä¸»')
                else:
                    print('æœ¨ç¨®è¼¸å…¥éŒ¯èª¤!!')

        elif å ±åƒ¹ == 'å ±åƒ¹å–®':
            # === 0. è·¯å¾‘è¨­å®š ===============================================
            try:
                base_dir = Path(__file__).resolve().parent  # æ­£å¸¸åŸ·è¡Œ .py æ™‚
            except NameError:
                base_dir = Path.cwd()
            TEMPLATE   = base_dir / "FUNTEé›»å‹•å‡é™æ¡Œå ±åƒ¹å–®-ç©ºç™½å ±åƒ¹å–®.xlsx"
            PRODUCT_DB = base_dir / "å ±åƒ¹å–®ç”¢å“.xlsx"
            
            # === 1. è®€ç”¢å“è³‡æ–™è¡¨ ==========================================
            items_df = pd.read_excel(PRODUCT_DB, header=14)
            items_df.columns = items_df.columns.str.strip()
            items_df.set_index("Item No.", inplace=True)
            
            # === 2. å®¢æˆ¶è³‡æ–™ ==============================================
            customer = {
                "name": input("å§“åï¼å…¬å¸åï¼çµ±ç·¨ï¼š").strip(),
                "tel":  input("é›»è©±ï¼š").strip(),
                "addr": input("åœ°å€ï¼š").strip()
            }
            
            # === 3. å¤šå“é …è¼¸å…¥ ============================================
            orders = []
            while True:
                prod = input("ç”¢å“åç¨±ï¼ˆEnter çµæŸï¼‰ï¼š").strip()
                if not prod:
                    break
                if prod not in items_df.index:
                    print("âš ï¸ æ‰¾ä¸åˆ°æ­¤ç”¢å“ï¼Œè«‹é‡è¼¸")
                    continue
                orders.append({"row": items_df.loc[prod]})
            
            if not orders:
                print("âš ï¸ æ²’æœ‰è¼¸å…¥ä»»ä½•ç”¢å“ï¼Œç¨‹å¼çµæŸ")
                exit()
            
            # === 4. è®€ç¯„æœ¬ï¼Œå¯«å®¢æˆ¶è³‡æ–™ ===================================
            wb = openpyxl.load_workbook(TEMPLATE)
            ws = wb.active
            ws["A9"].value  = f"Messrsï¼š{customer['name']}"
            ws["A10"].value = f"TELï¼š{customer['tel']}"
            ws["A11"].value = f"ADDRï¼š{customer['addr']}"
            ws["C11"].value = f"DATEï¼š{date.today():%Y/%m/%d}"
            
            # === 5. æ’å…¥ç©ºç™½åˆ—ï¼šæŠŠåŸæœ¬ç¸½è¨ˆ/å‚™è¨»å¾€ä¸‹æ¨ =====================
            HEADER_ROW  = 15        # è¡¨é ­åœ¨ç¬¬ 15 åˆ—
            start_row   = HEADER_ROW + 1            # ç¬¬ä¸€ç­†è³‡æ–™ â†’ 16
            extra_rows  = len(orders) - 1
            if extra_rows > 0:
                ws.insert_rows(
                    idx=start_row + 1, amount=extra_rows)
            
            # === 6. å¯«ç”¢å“åˆ— & åœ–ç‰‡ =====================================
            for i, od in enumerate(orders):
                row      = start_row + i
                r        = od["row"]
            
                #ws.cell(row, 1, r["Item No."])
                ws.cell(row, 2, r["Description"])
                ws.cell(row, 3).value = f"=ROUND({r["Price (NTD)"]}, 0)" 
                ws.cell(row, 5, f"=C{row}*D{row}")             # E æ¬„å°è¨ˆ
            
                # æ’åœ–ï¼ˆè·¯å¾‘ç”¨ base_dirï¼‰
                        
                item_no = str(r.name).strip()        # å–å¾—ã€Œå¤§æ´æ´æ¿ã€
                img_path = base_dir / "å ±åƒ¹å–®ç”¢å“åœ–æª”" / f"{item_no}.JPG"
                if img_path.exists():
                    img = Image(str(img_path))
                    img.width, img.height = 120, 90
                    ws.column_dimensions["A"].width = 18  # å¤§ç´„é©åˆ120pxåœ–ç‰‡
                    ws.add_image(img, f"A{row}")
                else:
                    print(f"âš ï¸ æ‰¾ä¸åˆ°åœ–ç‰‡ï¼š{img_path}")
            
            # === 7. é‡å¯«ç¸½è¨ˆåˆ—å…¬å¼ =======================================
            total_row = start_row + len(orders)
            ws.cell(total_row, 1, "ç¸½è¨ˆæ–°å°å¹£ï¼ˆå«ç¨…ï¼‰")
            ws.cell(total_row, 5, f"=SUM(E{start_row}:E{total_row-1})")
            
            # === 8. å¦å­˜æª”æ¡ˆ =============================================
            safe_name = customer["name"].replace(" ", "_")
            outfile = base_dir / f"FUNTEé›»å‹•å‡é™æ¡Œå ±åƒ¹å–®_{safe_name}_{date.today():%Y%m%d}.xlsx"
            wb.save(outfile)
            
            print(f"\nâœ… å ±åƒ¹å–®å·²ç”¢ç”Ÿï¼š{outfile}")
            
        elif å ±åƒ¹ == 'ä¸‹å–®':            
            ACCESS_TOKEN = 'SHOPLINE_API_KEY'
            API_BASE_URL = 'https://open.shopline.io/v1'

            headers = {
                'Authorization': f'Bearer {ACCESS_TOKEN}',
                'Content-Type': 'application/json'
            }

            try:
                custom_name = input('è«‹è¼¸å…¥å§“å: ')
                custom_product = input('è«‹è¼¸å…¥å•†å“åç¨±: ')
                custom_price = int(input('è«‹è¼¸å…¥åƒ¹æ ¼: '))
                custom_sku = input('è«‹è¼¸å…¥ç‰©æ–™(CD01/CD02):')
                custom_url_code = input('è«‹è¼¸å…¥é€£çµç·¨ç¢¼: ')
            except Exception as e:
                print('è¼¸å…¥éŒ¯èª¤ï¼ŒåŸå› :', e)
            else:

                payload = {
                    "product": {
                        "title_translations": {
                            "zh-hant": f"ã€{custom_name}ã€‘-{custom_product}"
                        },
                        "category_ids":[
                            "5f3e6edecbccfd003c3fc43f","6620f0d9de0f7400174633cd"
                        ],
                        "summary_translations": {
                            "zh-hant": f"ğŸ”ºè£½ä½œå¤©æ•¸ä¸å«é…é€æ™‚é–“ï¼Œå•†å“å®Œæˆå¾Œå°‡ä¾è¨‚å–®é †åºå®‰æ’å‡ºè²¨"
                        },
                        "price": 99999,  # åŸåƒ¹ï¼Œå¯è¦–æƒ…æ³èª¿æ•´
                        "price_sale": custom_price,
                        "unlimited_quantity": True,
                        "sku": custom_sku,
                        "weight": 50,
                        "status": "hidden",
                        "retail_status":"draft",
                        "blacklisted_payment_ids": [
                            "59d302ce080f065a31000066"
                        ],
                        "images": [
                            "SHOPLINE_IMAGES"
                        ],
                        "link": custom_url_code
                    }
                }

                product_url = f'{API_BASE_URL}/products'

                response = requests.post(product_url, headers=headers, json=payload)

                if response.status_code == 201:
                    base_url = 'https://www.funtetw.com/products/'
                    print(f'âœ… å·²ç”Ÿæˆé€£çµï¼š{base_url}{custom_url_code}')

                else:
                    print(f'âŒ å»ºç«‹å¤±æ•—ï¼Œç‹€æ…‹ç¢¼ï¼š{response.status_code}')
                    print(response.text)

        else:
            print('é¸é …è¼¸å…¥éŒ¯èª¤!!')
    
input('è«‹æŒ‰enteréµçµæŸ')
    #again = input("è¦é‡æ–°å ±åƒ¹å—ï¼Ÿ(y/n)ï¼š")
    #if again.lower() != 'y':
            #break